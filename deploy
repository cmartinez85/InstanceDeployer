#Variables
OS_RC=deployRC
SSHCON="ssh -i deployerkey"
OP_CONTROLLER=192.168.1.37
f_sshConfig(){
# Funci贸 per validar la configuraci贸 ssh per poder enviar variables d'entorn per ssh
  grep "^SendEnv OS_AUTH_URL OS_TENANT_ID OS_TENANT_NAME OS_USERNAME OS_PASSWORD" $HOME/.ssh/config > /dev/null;
  if [ $? -eq 0 ];
  then
    echo -e "- Parametros de traspaso de variables\t\t [OK]"
  else
    echo AcceptEnv OS_AUTH_URL OS_TENANT_ID OS_TENANT_NAME OS_USERNAME OS_PASSWORD >> /etc/ssh/sshd_config
  fi
}
f_sshClearConfig(){
  sed -i 's/SendEnv OS_AUTH_URL OS_TENANT_ID OS_TENANT_NAME OS_USERNAME OS_PASSWORD//g' $HOME/.ssh/config
}
f_sshConfig
source $OS_RC
$SSHCON deployer@$OP_CONTROLLER -C "nova --os-username $OS_USERNAME --os-password $OS_PASSWORD list" > /dev/null
if [ $? -eq 0 ];
then
  echo -e "- Verificaci贸 de credencials\t\t [OK]"
else
  echo -e "- Verificaci贸 de credencials\t\t [NOK]"
  exit 1
fi
#credencials verificades
$SSHCON deployer@$OP_CONTROLLER -C "nova boot --image wsGeneral --flavor m1.tiny --key-name $OS_USERNAME ws$OS_USERNAME" > /dev/null
